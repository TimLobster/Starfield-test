<canvas class="canvas"></canvas>

<script lang="js">
    function random(min, max) {
        return min + Math.random() * (max + 1 - min);
    }

    const canvas = document.querySelector('.canvas');
    const ctx = canvas.getContext("2d");

    let starsArray = [];
    let started = false;

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    function random(min, max) {
        return min + Math.random() * (max + 1 - min);
    }

    window.addEventListener('resize', function() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        //Re-add the stars
        stars();
    });

    function stars() {
        //Add stars to a small fraction of the canvas
        const canvasSize = canvas.width * canvas.height;
        const starsFraction = canvasSize / 20000;

        for(let i = 0; i < starsFraction; i++) {
            //Set up random elements
            let xPos = random(2, canvas.width - 2);
            let yPos = random(2, canvas.height - 2);
            let alpha = random(0.5, 1);
            let size = 8;
            let colour = getRndColor();

            starsArray.push([
                xPos,
                yPos,
                alpha,
                colour
            ]);

            if (!started) {
                started = true;
                setInterval(() => {
                    // console.log(Math.floor(Math.random() * 2));
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    starsArray.forEach(x => {
                        ctx.shadowBlur = 10;
                        ctx.shadowColor = x[3];
                        ctx.fillStyle = x[3];

                        if (x[2] >= 0) {
                            x[2] -= 0.1;
                        }

                        if (x[2] <= 0.25) {
                            if (Math.floor(Math.random() * 100) === 1) {
                                x[2] = 1;
                            }
                        }

                        ctx.globalAlpha = x[2];
                        ctx.fillRect(x[0], x[1], size, size);
                    });

                    starsArray = starsArray.forEach(x => {
                        x[0] += size;

                        if (x[0] >= canvas.width) {
                            x[0] = 0;
                        }
                    })
                        .filter(x => x < canvas.width);                    
                }, 50)
            }
        }
    }

    function getRndColor() {
        var r = 255*Math.random()|0,
            g = 255*Math.random()|0,
            b = 255*Math.random()|0;
        return 'rgb(' + r + ',' + g + ',' + b + ')';
    }

    //Add the stars
    stars();
</script>

<style lang="css">
    html,
    body {
        height: 100%;  
    }

    body {
        overflow: hidden;
        background-color: black;
    }
</style>